define("aiplacement_aipsample/placement",["exports","core/templates","core/ajax","core_ai/helper","core/str","core/notification"],(function(_exports,_templates,_ajax,_helper,_str,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Module to load and render the tools for the placement.
   *
   * Note that we completely ignore user agreement and privacy policy here
   * for simplicity but it should be a consideration in a real implementation.
   *
   * @module     aiplacement_aipsample/placement
   * @copyright  2024 Laurent David <laurent.david@moodle.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax),_helper=_interopRequireDefault(_helper),_notification=_interopRequireDefault(_notification);const Selectors_ELEMENTS={AIRESPONSE_AREA:'.aipsample-placement-ui [data-region="response"]'},Selectors_ACTIONS={RUN:'.aipsample-placement-ui [data-action="run"]'};var _default=class{constructor(userId,contextId){this.userId=userId,this.contextId=contextId,this.aiResponseArea=document.querySelector(Selectors_ELEMENTS.AIRESPONSE_AREA),this.registerEventListeners()}registerEventListeners(){document.querySelectorAll(Selectors_ACTIONS.RUN).forEach((el=>el.addEventListener("click",(async e=>{if(e.target.closest(Selectors_ACTIONS.RUN)){e.preventDefault(),this.displayLoading(),this.aiResponseArea.innerHTML="";const request={methodname:"aiplacement_aipsample_generate_content",args:{userid:this.userId,contextid:this.contextId,prompttext:await(0,_str.getString)("prompttext","aiplacement_aipsample")}};try{const responseObj=await _ajax.default.call([request])[0];if(responseObj.error)return void this.displayError();{const generatedContent=_helper.default.replaceLineBreaks(responseObj.generatedcontent);this.displayResponse(generatedContent)}}catch(error){window.console.log(error),this.displayError()}}}))))}displayLoading(){_templates.default.render("aiplacement_aipsample/loading",{}).then((html=>{this.aiResponseArea.innerHTML=html})).catch(_notification.default.exception)}displayResponse(content){_templates.default.render("aiplacement_aipsample/response",{content:content}).then((html=>{this.aiResponseArea.innerHTML=html})).catch(_notification.default.exception)}displayError(){_templates.default.render("aiplacement_aipsample/error",{}).then((html=>{this.aiResponseArea.innerHTML=html})).catch(_notification.default.exception)}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=placement.min.js.map